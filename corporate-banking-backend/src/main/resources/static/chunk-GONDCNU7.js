import{b as S,f as D,i as T,s as V}from"./chunk-M3L7I6SR.js";import{Ec as A,Hc as j,Nb as r,Oa as o,Ob as P,Pb as p,Qb as E,Rb as O,Sb as y,T as h,X as b,Xa as x,ba as g,bb as M,ca as f,dc as I,fb as u,pb as l,qb as a,rb as i,sc as k,tc as w,uc as R,wb as v,yb as C,yc as q,zb as c}from"./chunk-6NNWKDWV.js";var _=class t{constructor(n){this.http=n}baseUrl=`${j.apiUrl}/credit-requests`;getAllCredits(){return this.http.get(this.baseUrl)}decideCredit(n,e,s){return this.http.put(`${this.baseUrl}/${n}`,{status:e,remarks:s})}static \u0275fac=function(e){return new(e||t)(b(A))};static \u0275prov=h({token:t,factory:t.\u0275fac,providedIn:"root"})};function J(t,n){t&1&&(a(0,"div",8),r(1,"Loading..."),i())}function U(t,n){if(t&1&&(a(0,"div",9),r(1),i()),t&2){let e=c();o(),P(e.error)}}function $(t,n){if(t&1){let e=v();a(0,"div",18)(1,"button",19),C("click",function(){g(e);let d=c().$implicit,m=c(2);return f(m.openModal(d.id,"APPROVED"))}),r(2," Approve "),i(),a(3,"button",20),C("click",function(){g(e);let d=c().$implicit,m=c(2);return f(m.openModal(d.id,"REJECTED"))}),r(4," Reject "),i()()}}function H(t,n){if(t&1&&(a(0,"div",12)(1,"div",13),r(2),i(),a(3,"div",14)(4,"div")(5,"span"),r(6,"Amount:"),i(),r(7),i(),a(8,"div")(9,"span"),r(10,"Tenure:"),i(),r(11),i(),a(12,"div")(13,"span"),r(14,"Purpose:"),i(),r(15),i()(),a(16,"div",15)(17,"span",16),r(18),i()(),u(19,$,5,0,"div",17),i()),t&2){let e=n.$implicit;o(2),p(" Client ID: ",e.clientId," "),o(5),p(" \u20B9 ",e.requestAmount),o(4),p(" ",e.tenureMonths," months"),o(4),p(" ",e.purpose),o(2),l("ngClass",e.status),o(),p(" ",e.status," "),o(),l("ngIf",e.status==="PENDING")}}function W(t,n){if(t&1&&(a(0,"div",10),u(1,H,20,7,"div",11),i()),t&2){let e=c();o(),l("ngForOf",e.credits)}}function z(t,n){t&1&&(a(0,"div",21),r(1," No credit requests found. "),i())}function B(t,n){if(t&1){let e=v();a(0,"div",22)(1,"div",23)(2,"h3"),r(3),i(),a(4,"textarea",24),y("ngModelChange",function(d){g(e);let m=c();return O(m.remarks,d)||(m.remarks=d),f(d)}),r(5,"    "),i(),a(6,"div",25)(7,"button",26),C("click",function(){g(e);let d=c();return f(d.submitDecision())}),r(8," Confirm "),i(),a(9,"button",27),C("click",function(){g(e);let d=c();return f(d.closeModal())}),r(10,"Cancel"),i()()()()}if(t&2){let e=c();o(3),p("",e.selectedAction," Credit"),o(),E("ngModel",e.remarks),o(3),l("disabled",e.decisionLoading)}}var N=class t{constructor(n,e){this.creditService=n;this.cd=e}credits=[];loading=!0;error="";showModal=!1;selectedCreditId="";selectedAction=null;remarks="";decisionLoading=!1;ngOnInit(){this.loadCredits()}loadCredits(){this.loading=!0,this.creditService.getAllCredits().subscribe({next:n=>{console.log("API DATA \u{1F449}",n),this.credits=n,this.loading=!1,this.cd.detectChanges()},error:()=>{this.error="Failed to load credit requests",this.loading=!1}})}openModal(n,e){this.selectedCreditId=n,this.selectedAction=e,this.remarks="",this.showModal=!0}submitDecision(){if(this.selectedAction){if(!this.remarks.trim()){alert("Remarks are required");return}this.decisionLoading=!0,this.creditService.decideCredit(this.selectedCreditId,this.selectedAction,this.remarks).subscribe({next:()=>{this.decisionLoading=!1,this.closeModal(),this.loadCredits()},error:()=>{this.decisionLoading=!1,alert("Failed to update decision")}})}}closeModal(){this.showModal=!1,this.selectedCreditId="",this.selectedAction=null,this.remarks=""}static \u0275fac=function(e){return new(e||t)(x(_),x(I))};static \u0275cmp=M({type:t,selectors:[["app-credit-requests"]],decls:9,vars:5,consts:[[1,"page-container"],[1,"page-title-wrapper"],[1,"page-title-pill"],["class","loading",4,"ngIf"],["class","error",4,"ngIf"],["class","grid",4,"ngIf"],["class","empty",4,"ngIf"],["class","modal-backdrop",4,"ngIf"],[1,"loading"],[1,"error"],[1,"grid"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"client-id"],[1,"details"],[1,"status-wrapper"],[1,"status-pill",3,"ngClass"],["class","actions",4,"ngIf"],[1,"actions"],[1,"approve",3,"click"],[1,"reject",3,"click"],[1,"empty"],[1,"modal-backdrop"],[1,"modal"],["placeholder","Enter remarks",3,"ngModelChange","ngModel"],[1,"modal-actions"],[3,"click","disabled"],[1,"cancel",3,"click"]],template:function(e,s){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),r(3," All Credit Requests "),i()(),u(4,J,2,0,"div",3)(5,U,2,1,"div",4)(6,W,2,1,"div",5)(7,z,2,0,"div",6),i(),u(8,B,11,3,"div",7)),e&2&&(o(4),l("ngIf",s.loading),o(),l("ngIf",s.error),o(),l("ngIf",!s.loading&&s.credits.length),o(),l("ngIf",!s.loading&&!s.credits.length),o(),l("ngIf",s.showModal))},dependencies:[q,k,w,R,V,S,D,T],styles:[".page-container[_ngcontent-%COMP%]{padding:24px;background:#f5f7fb;min-height:100vh}.page-title-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:28px}.page-title-pill[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2563eb,#1e40af);color:#fff;padding:12px 36px;border-radius:999px;font-size:20px;font-weight:600;box-shadow:0 8px 20px #2563eb59}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:20px}.card[_ngcontent-%COMP%]{background:#fff;border-radius:14px;padding:18px;box-shadow:0 10px 28px #00000014;transition:transform .2s ease}.card[_ngcontent-%COMP%]:hover{transform:translateY(-4px)}.client-id[_ngcontent-%COMP%]{font-weight:600;margin-bottom:12px;color:#1f2937}.details[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:6px;color:#374151}.details[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600}.status-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:14px 0}.status-pill[_ngcontent-%COMP%]{padding:6px 18px;border-radius:999px;font-size:13px;font-weight:600}.PENDING[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.APPROVED[_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.REJECTED[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:14px;margin-top:12px}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 18px;border-radius:8px;border:none;cursor:pointer;font-weight:600}.approve[_ngcontent-%COMP%]{background:#16a34a;color:#fff}.reject[_ngcontent-%COMP%]{background:#dc2626;color:#fff}.modal-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000073;display:flex;align-items:center;justify-content:center}.modal[_ngcontent-%COMP%]{background:#fff;padding:22px;width:340px;border-radius:12px}textarea[_ngcontent-%COMP%]{width:100%;height:90px;margin:12px 0}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px}.cancel[_ngcontent-%COMP%]{background:#6b7280;color:#fff}.loading[_ngcontent-%COMP%], .empty[_ngcontent-%COMP%]{text-align:center;margin-top:40px;font-weight:500}.error[_ngcontent-%COMP%]{color:red;text-align:center}"]})};export{N as CreditRequestsComponent};
